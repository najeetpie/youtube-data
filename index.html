<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>YouTube Video Data Fetcher</title>
    <script>
        async function fetchVideoData(videoUrl) {
            const videoId = getYouTubeVideoID(videoUrl);
            if (!videoId) {
                return { error: 'Invalid YouTube URL' };
            }

            try {
                const noembedData = await fetch(`https://noembed.com/embed?url=https://www.youtube.com/watch?v=${videoId}`).then(res => res.json());

                const duration = await fetchDuration(videoId);

                return {
                    author: noembedData.author_name,
                    title: noembedData.title,
                    duration_seconds: duration,
                    thumbnail: noembedData.thumbnail_url
                };

            } catch (error) {
                return { error: error.message };
            }
        }

        function getYouTubeVideoID(url) {
            const match = url.match(/(?:https?:\/\/)?(?:www\.)?(?:youtube\.com\/(?:watch\?v=|shorts\/)|youtu\.be\/)([\w-]{11})/);
            return match ? match[1] : null;
        }

        async function fetchDuration(videoId) {
            const watchUrl = `https://corsproxy.io/?https://www.youtube.com/watch?v=${videoId}`;
            const response = await fetch(watchUrl);
            const html = await response.text();
            const match = html.match(/"lengthSeconds":"(\d+)"/);
            return match ? parseInt(match[1]) : null;
        }

        async function handlePageLoad() {
            const params = new URLSearchParams(window.location.search);
            const videoUrl = params.get('url');

            if (videoUrl) {
                const data = await fetchVideoData(videoUrl);
                document.body.innerText = JSON.stringify(data, null, 2);
            }
        }

        window.addEventListener('DOMContentLoaded', handlePageLoad);
    </script>
</head>
<body>
    <div id="interactive-ui">
        <h1>YouTube Video Data Fetcher</h1>
        <input type="text" id="videoUrl" placeholder="Enter YouTube URL">
        <button onclick="getData()">Get Video Data</button>
        <pre id="result"></pre>
    </div>

    <script>
        async function getData() {
            const url = document.getElementById('videoUrl').value;
            const data = await fetchVideoData(url);
            document.getElementById('result').innerText = JSON.stringify(data, null, 2);
        }

        const params = new URLSearchParams(window.location.search);
        if (params.get('url')) {
            document.getElementById('interactive-ui').style.display = 'none';
        }
    </script>
</body>
</html>
